(function(global){const kitmodule=global.kitmodule||(global.kitmodule={});function isLocalhost(){if(kitmodule._isLocalHost===0[0]){const hostname=location.hostname;kitmodule._isLocalHost=["localhost","127.0.0.1","::1"].includes(hostname)||hostname.startsWith("127.")}return kitmodule._isLocalHost}function kitDebug(isLocal=!0){isLocal&&console.log(kitmodule)}kitmodule.debug=kitDebug,kitmodule.isLocalhost=isLocalhost,kitDebug(isLocalhost())})(typeof window!="undefined"?window:globalThis),function(global){const kitmodule=global.kitmodule||(global.kitmodule={});function KitScript(source){this.source=source}KitScript.prototype.version=function(){if(!this.source)return null;let match=this.source.match(/\/(\d+\.\d+\.\d+)\//);return match?match[1]:null},KitScript.prototype.param=function(param){const searchParams=new URL(this.source).searchParams,value=searchParams.get(param);return searchParams.has(param)?value:0[0]},kitmodule.scriptParam=(source,param)=>new KitScript(source).param(param),kitmodule.scriptVersion=source=>new KitScript(source).version()}(typeof window!="undefined"?window:globalThis),function(global){const kitmodule=global.kitmodule||(global.kitmodule={}),{query:KitQuery}=kitmodule;function KitURL(href=window.location.href){this.url=new URL(href),this.params=this.url.searchParams}KitURL.prototype.query=function(){return KitQuery(this.url)},KitURL.prototype.getParam=function(key){return this.params.get(key)},KitURL.prototype.getParams=function(){const result={};for(const[key,value]of this.params.entries())result.hasOwnProperty(key)?Array.isArray(result[key])?result[key].push(value):result[key]=[result[key],value]:result[key]=value;return result},KitURL.prototype.deleteParam=function(key){return this.params.delete(key),this},KitURL.prototype.extractParam=function(key){const value=this.getParam(key);return value!==null&&this.deleteParam(key),value},KitURL.prototype.replaceState=function(){const newSearch=this.params.toString(),newUrl=`${this.url.pathname}${newSearch?`?${newSearch}`:""}${this.url.hash}`;return window.history.replaceState({},"",newUrl),this},kitmodule.url=KitURL}(typeof window!="undefined"?window:globalThis),function(global){const kitmodule=global.kitmodule||(global.kitmodule={});function KitBase64(charString){this.charString=charString}KitBase64.prototype.encode=function(){if(typeof TextEncoder=="undefined")throw new Error("TextEncoder is not supported in this environment.");const bytes=(new TextEncoder).encode(this.charString),binary=Array.from(bytes,b=>String.fromCharCode(b)).join("");return btoa(binary)},KitBase64.prototype.decode=function(){if(typeof TextDecoder=="undefined")throw new Error("TextDecoder is not supported in this environment.");const binary=atob(this.charString),bytes=Uint8Array.from(binary,c=>c.charCodeAt(0));return(new TextDecoder).decode(bytes)},kitmodule.base64=KitBase64,kitmodule.base64Encode=text=>new KitBase64(text).encode(),kitmodule.base64Decode=text=>new KitBase64(text).decode()}(typeof window!="undefined"?window:globalThis),function(global){const kitmodule=global.kitmodule||(global.kitmodule={});function KitCookie(){}KitCookie.prototype._encode=function(value,method="uri"){if(value==null)return"";switch(method){case"base64":return btoa(unescape(encodeURIComponent(value)));case"none":return value;case"uri":default:return encodeURIComponent(value)}},KitCookie.prototype._decode=function(value,method="uri"){if(!value)return"";switch(method){case"base64":return decodeURIComponent(escape(atob(value)));case"none":return value;case"uri":default:return decodeURIComponent(value)}},KitCookie.prototype.set=function(name,value,options={}){let encodedValue=this._encode(value,options.encode),cookieStr=name+"="+encodedValue;if(options.expires){const d=new Date;typeof options.expires=="number"?d.setTime(d.getTime()+options.expires*24*60*60*1e3):options.expires instanceof Date&&d.setTime(options.expires.getTime()),cookieStr+="; expires="+d.toUTCString()}cookieStr+="; path="+(options.path||"/"),options.domain&&(cookieStr+="; domain="+options.domain),options.secure&&(cookieStr+="; secure"),options.sameSite&&(cookieStr+="; samesite="+options.sameSite),document.cookie=cookieStr},KitCookie.prototype.get=function(name,options={}){const cookies=document.cookie.split(";").reduce((acc,c)=>{let[k,v]=c.split("=");return k&&(acc[k.trim()]=v?v.trim():""),acc},{});if(!name){for(let k in cookies)cookies[k]=this._decode(cookies[k],options.decode);return cookies}return name in cookies?this._decode(cookies[name],options.decode):0[0]},KitCookie.prototype.has=function(name){return this.get(name)!==0[0]},KitCookie.prototype.remove=function(name,options={}){document.cookie=name+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path="+(options.path||"/")+(options.domain?"; domain="+options.domain:"")},KitCookie.prototype.clean=function(){const cookies=this.get();for(let name in cookies)this.remove(name)},kitmodule.cookie=new KitCookie}(typeof window!="undefined"?window:globalThis),function(global){const kitmodule=global.kitmodule||(global.kitmodule={});function KitQuery(href=window.location.href){this.url=new URL(href,window.location.origin),this.params=this.url.searchParams}KitQuery.prototype.reset=function(href=window.location.href){return this.url=new URL(href,window.location.origin),this.params=this.url.searchParams,this},KitQuery.prototype.get=function(key){return typeof key=="undefined"?this.toObject():this.params.get(key)},KitQuery.prototype.toObject=function(){const result={};for(const[k,v]of this.params.entries())result.hasOwnProperty(k)?result[k]=Array.isArray(result[k])?[...result[k],v]:[result[k],v]:result[k]=v;return result},KitQuery.prototype.toString=function(){return this.params.toString()},KitQuery.prototype.toSearch=function(){let str=this.toString();return str?str.startsWith("?")?str:"?"+str:""},KitQuery.prototype.set=function(...args){return this._handleArgs(args,(k,v)=>this.params.set(k,v))},KitQuery.prototype.add=function(...args){return this._handleArgs(args,(k,v)=>this.params.append(k,v))},KitQuery.prototype.with=function(...args){return this._handleArgs(args,(k,v)=>{this.params.has(k)||this.params.set(k,v)})},KitQuery.prototype.delete=function(key){return this.params.delete(key),this},KitQuery.prototype.remove=function(...keys){return keys.forEach(k=>this.params.delete(k)),this},KitQuery.prototype.assign=function(...args){return this.clean().set(...args)},KitQuery.prototype.extract=function(key){const value=this.get(key);return value!==null&&this.remove(key),value},KitQuery.prototype.clean=function(){return this.params=new URLSearchParams,this.url.search="",this},KitQuery.prototype.replaceState=function(data={}){return this.state("replace",data)},KitQuery.prototype.pushState=function(data={}){return this.state("push",data)},KitQuery.prototype.state=function(type="replace",data={}){const newSearch=this.params.toString(),newUrl=`${this.url.pathname}${newSearch?`?${newSearch}`:""}${this.url.hash}`;return type==="push"?window.history.pushState(data,null,newUrl):window.history.replaceState(data,null,newUrl),this},KitQuery.prototype.next=function(key="page"){let current=parseInt(this.get(key)||"1",10);return(isNaN(current)||current<1)&&(current=1),this.set(key,current+1),this},KitQuery.prototype.previous=function(key="page"){let current=parseInt(this.get(key)||"1",10);return isNaN(current)||current<=1?current=1:current=current-1,this.set(key,current),this},KitQuery.prototype.goto=function(page,key="page"){let target=parseInt(page,10);return(target!=target||target<1)&&(target=1),this.set(key,target),this},KitQuery.prototype._handleArgs=function(args,handler){if(args.length===1&&typeof args[0]=="object"&&args[0]!==null)for(const[k,v]of Object.entries(args[0]))handler(k,v);else if(args.length===2)handler(args[0],args[1]);else if(args.length>2&&args.length%2===0)for(let i=0;i<args.length;i+=2)handler(args[i],args[i+1]);else throw new Error("Invalid arguments");return this},kitmodule.query=new KitQuery}(typeof window!="undefined"?window:globalThis),function(global){const kitmodule=global.kitmodule||(global.kitmodule={}),kitMinimize=v=>new kitmodule.minimize(v),kitBase64=v=>new kitmodule.base64(v);function KitHasher(input){this.value=input,this.ensign=null}function extractDigits(str){return str.split("").filter(c=>c>="0"&&c<="9").join("")}KitHasher.prototype.decodeRemaining=function(encodedRemaining,base62){const numericBase=extractDigits(base62),bigintValue=kitMinimize(base62).toBigInt(encodedRemaining),decimalStr=kitMinimize(numericBase).toBigInt(bigintValue);return Number(decimalStr)},KitHasher.prototype.decode=function(hashToken){const BASE_LENGTH=62;if(hashToken.length<=BASE_LENGTH+2)throw new Error("Token không hợp lệ: độ dài quá ngắn.");const base=hashToken.slice(0,BASE_LENGTH);let rest=hashToken.slice(BASE_LENGTH);const salt1=rest[0],createdLength=base.indexOf(salt1);if(createdLength<0)throw new Error("Salt1 không hợp lệ.");rest=rest.slice(1);const created=rest.slice(0,createdLength);rest=rest.slice(createdLength);const salt2=rest[0],remainingLength=base.indexOf(salt2);if(remainingLength<0)throw new Error("Salt2 không hợp lệ.");rest=rest.slice(1);const remainingHash=rest.slice(0,remainingLength),remainingString=this.decodeRemaining(remainingHash,base),remaining=Number(remainingString),expirated=new Date(Date.now()+remaining);return{base,created,remaining,expirated}},KitHasher.prototype.encode=function(hash){let{base}=this.decode(hash),text64=kitBase64(this.value).encode();var result=hash+kitMinimize(base).encode(text64);return result};async function fetchHasher(name){if(this.ensign)return this.ensign;try{const response=await fetch("/api/hasher/"+name,{method:"GET",headers:{Accept:"application/json"}});if(!response.ok)throw new Error("Không thể lấy ensign từ server");const result=await response.json();return result.success?result.data:result.message?new Error(result.message):null}catch(error){throw console.error("Lỗi khi lấy ensign:",error),error}}KitHasher.prototype.fetch=async function(name){const hash=await fetchHasher(name);if(hash)return this.encode(hash)},kitmodule.hasher=KitHasher}(typeof window!="undefined"?window:globalThis),function(global){const kitmodule=global.kitmodule||(global.kitmodule={}),defaultAllowedTags=["b","i","em","strong","a","p","br","ul","ol","li","span","div","img","h1","h2","h3","h4","h5","h6","table","thead","tbody","tr","td","th","blockquote","code","pre","image","svg","path","circle","rect","line","polygon","polyline","ellipse","g","defs","linearGradient","radialGradient","stop","filter","feGaussianBlur","feOffset","feBlend","feColorMatrix","clipPath","pattern","use","symbol"],defaultAllowedAttributes={a:["href","title","target","rel"],img:["src","alt","title","width","height"],svg:["viewBox","viewbox","width","height","xmlns","fill","stroke","stroke-width","role","aria-hidden","style"],pattern:["x","y","width","height"],path:["d","fill","stroke","stroke-width","transform"],circle:["cx","cy","r","fill","stroke","stroke-width"],rect:["x","y","width","height","rx","ry","fill","stroke","stroke-width","style"],ellipse:["cx","cy","rx","ry","fill","stroke","stroke-width"],line:["x1","y1","x2","y2","stroke","stroke-width"],polyline:["points","fill","stroke","stroke-width"],polygon:["points","fill","stroke","stroke-width"],text:["x","y","fill","font-size","text-anchor","transform"],image:["x","y","width","height","href","xlink:href"],use:["href","xlink:href","width","height","x","y"],"*":["class","id","style"]},forbiddenTags=["script","style","iframe","object","embed","link","meta"];function kitSanitize(inputHTML,options={}){const allowedTags=options.allowedTags||defaultAllowedTags,allowedAttributes=options.allowedAttributes||defaultAllowedAttributes,parser=new DOMParser,doc=parser.parseFromString(inputHTML,"text/html");function isSafeUrl(url){if(!url)return!1;const safeProtocols=["http:","https:","mailto:","tel:","data:"];try{const parsed=new URL(url,location.origin);return safeProtocols.includes(parsed.protocol)}catch{return!1}}function cleanNode(node){let child=node.firstChild;for(;child;){const next=child.nextSibling;if(child.nodeType===Node.ELEMENT_NODE){const tagName=child.tagName.toLowerCase();forbiddenTags.includes(tagName)||!allowedTags.includes(tagName)?child.remove():([...child.attributes].forEach(attr=>{const attrName=attr.name.toLowerCase(),allowedForTag=allowedAttributes[tagName]||[],allowedForAll=allowedAttributes["*"]||[];if(![...allowedForTag,...allowedForAll].includes(attrName)){child.removeAttribute(attr.name);return}if(attrName.startsWith("on")){child.removeAttribute(attr.name);return}if(attrName==="style"){const css=attr.value;/javascript:|expression\(|url\s*\(/i.test(css)&&child.removeAttribute(attr.name);return}if((attrName==="href"||attrName==="src"||attrName==="xlink:href")&&!isSafeUrl(attr.value)){child.removeAttribute(attr.name);return}if(tagName==="a"&&attrName==="target"&&attr.value==="_blank"){const rel=child.getAttribute("rel")||"";rel.includes("noopener")||child.setAttribute("rel",(rel+" noopener noreferrer").trim())}}),cleanNode(child))}else child.nodeType===Node.COMMENT_NODE?child.remove():child.nodeType!==Node.TEXT_NODE&&child.remove();child=next}}return cleanNode(doc.body),doc.body.innerHTML}kitmodule.sanitizeHTML=kitSanitize}(typeof window!="undefined"?window:globalThis),function(global){const kitmodule=global.kitmodule||(global.kitmodule={});function kitLexer(input){const length=input.length,tokens=[];let i=0;const isDigit=ch=>ch>="0"&&ch<="9",isAlpha=ch=>/[a-zA-Z_$]/.test(ch),isAlphaNum=ch=>/[a-zA-Z0-9_$]/.test(ch),isWhitespace=ch=>/\s/.test(ch),punctuators=new Set(["===","!==","==","!=","<=",">=","<<",">>",">>>","**","&&","||","+","-","*","/","%","**","<",">","=","!","&","|","^","~","?",":",".",",",";","(",")","{","}","[","]","++","--"]);function peek(offset=0){return input[i+offset]}function consume(){return input[i++]}function readNumber(){let num="",start=i;for(;isDigit(peek());)num+=consume();if(peek()===".")for(num+=consume();isDigit(peek());)num+=consume();let end=i-1;return{type:"number",value:parseFloat(num),start,end}}function readIdentifier(){let id="",start=i;for(;peek()!=null&&isAlphaNum(peek());)id+=consume();let end=i-1;return{type:"identifier",value:id,start,end}}function readString(){const quote=consume();let str="",start=i-1;for(;i<length&&peek()!==quote;){const ch=consume();str+=ch==="\\"?consume():ch}consume();let end=i-1;return{type:"string",value:str,quote,start,end}}function readOperatorOrPunctuator(){for(let len=3;len>=1;len--){if(i+len>input.length)continue;const candidate=input.slice(i,i+len);if(punctuators.has(candidate)){let start=i;i+=len;let end=i-1;return["(",")"].includes(candidate)?{type:"paren",value:candidate,start,end}:["{","}"].includes(candidate)?{type:"brace",value:candidate,start,end}:["[","]"].includes(candidate)?{type:"bracket",value:candidate,start,end}:[":",".",",","?"].includes(candidate)?{type:"punctuator",value:candidate,start,end}:candidate===";"?{type:"semicolon",value:";",start,end}:{type:"operator",value:candidate,start,end}}}let start=i,val=consume(),end=i-1;return{type:"unknown",value:val,start,end}}for(;i<length;){const ch=peek();if(isWhitespace(ch)){i++;continue}if(isDigit(ch)){tokens.push(readNumber());continue}if(isAlpha(ch)){tokens.push(readIdentifier());continue}if(ch==='"'||ch==="'"||ch==="`"){tokens.push(readString());continue}tokens.push(readOperatorOrPunctuator())}return tokens}kitmodule.lexer=kitLexer}(typeof window!="undefined"?window:globalThis),function(global){const kitmodule=global.kitmodule||(global.kitmodule={});function kitAST(tokens){let i=0;const PRECEDENCE={"||":1,"&&":2,"==":3,"!=":3,"===":3,"!==":3,"<":4,">":4,"<=":4,">=":4,"+":5,"-":5,"*":6,"/":6,"%":6};function peek(offset=0){return tokens[i+offset]}function consume(){return tokens[i++]}function match(type,value){const token=peek();return token&&token.type===type&&(!value||token.value===value)}function expect(type,value){const token=consume();if(!token||token.type!==type||value&&token.value!==value)throw new Error(`Expected ${type} '${value}', got ${token?.type} '${token?.value}'`);return token}function parseMemberExpression(expr){for(;!0;)if(match("punctuator",".")){consume();const property=parsePrimary();expr={type:"MemberExpression",object:expr,property,computed:!1}}else if(match("bracket","[")){consume();const property=parseExpression();expect("bracket","]"),expr={type:"MemberExpression",object:expr,property,computed:!0}}else break;return expr}function parseCallee(){const token=peek();if(token.type==="identifier"){const idToken=consume();let expr={type:"Identifier",name:idToken.value};return expr=parseMemberExpression(expr),expr}if(match("paren","(")){consume();const expr=parseExpression();return expect("paren",")"),expr}throw new Error("Expected constructor (identifier or member) after 'new'")}function parsePrimary(){const token=peek();if(!token)throw new Error("Unexpected end of input");if(token.type==="identifier"&&token.value==="new"){consume();const callee=parseCallee();expect("paren","(");const args=[];if(!match("paren",")"))do args.push(parseExpression());while(match("punctuator",",")&&consume())return expect("paren",")"),{type:"NewExpression",callee,arguments:args}}if(match("paren","(")){consume();const expr=parseExpression();return expect("paren",")"),expr}if(match("brace","{"))return parseObjectExpression();if(match("bracket","["))return parseArrayExpression();if(token.type==="number")return consume(),{type:"Literal",value:token.value};if(token.type==="string")return consume(),{type:"Literal",value:token.value};if(match("operator","++")||match("operator","--")){const op=consume().value,argument=parsePrimary();return{type:"UpdateExpression",operator:op,argument,prefix:!0}}if(token.type==="identifier"){consume();let node={type:"Identifier",name:token.value};if(match("operator","++")||match("operator","--")){const op=consume().value;return{type:"UpdateExpression",operator:op,argument:node,prefix:!1}}return node}if(token.type==="operator"&&["!","+","-","~"].includes(token.value)){const op=token.value;consume();const argument=parsePrimary();return{type:"UnaryExpression",operator:op,argument,prefix:!0}}throw new Error(`Unexpected token: ${token.type} ${token.value}`)}function parseMemberAndCall(expr){for(;!0;)if(match("punctuator",".")){consume();const property=parsePrimary();expr={type:"MemberExpression",object:expr,property,computed:!1}}else if(match("bracket","[")){consume();const property=parseExpression();expect("bracket","]"),expr={type:"MemberExpression",object:expr,property,computed:!0}}else if(match("paren","(")){consume();const args=[];if(!match("paren",")"))do args.push(parseExpression());while(match("punctuator",",")&&consume())expect("paren",")"),expr={type:"CallExpression",callee:expr,arguments:args}}else break;return expr}function parseBinaryExpression(minPrecedence=0){let left=parseMemberAndCall(parsePrimary());for(;!0;){const token=peek();if(!token||token.type!=="operator")break;const precedence=PRECEDENCE[token.value];if(precedence===0[0]||precedence<minPrecedence)break;const op=token.value;consume();const right=parseBinaryExpression(precedence+1);left={type:"BinaryExpression",operator:op,left,right}}return left}function parseTernary(){let test=parseBinaryExpression();if(match("punctuator","?")){consume();const consequent=parseExpression();expect("punctuator",":");const alternate=parseExpression();return{type:"ConditionalExpression",test,consequent,alternate}}return test}function parseAssignment(){const left=parseTernary();if(match("operator","=")){const op=consume().value,right=parseAssignment();return{type:"AssignmentExpression",operator:op,left,right}}return left}function parseArrayExpression(){expect("bracket","[");const elements=[];for(;!match("bracket","]");)elements.push(parseExpression()),match("bracket","]")||expect("punctuator",",");return expect("bracket","]"),{type:"ArrayExpression",elements}}function parseObjectExpression(){expect("brace","{");const properties=[];for(;!match("brace","}");){const keyToken=expect("identifier"),key={type:"Identifier",name:keyToken.value};expect("punctuator",":");const value=parseExpression();properties.push({type:"Property",key,value}),match("brace","}")||expect("punctuator",",")}return expect("brace","}"),{type:"ObjectExpression",properties}}function parseExpression(){return parseAssignment()}function parseProgram(){const body=[];for(;i<tokens.length;){const expr=parseExpression();if(body.push(expr),match("semicolon",";"))consume();else break}return{type:"Program",body}}return parseProgram()}kitmodule.ast=kitAST}(typeof window!="undefined"?window:globalThis),function(global){const kitmodule=global.kitmodule||(global.kitmodule={});function kitAST(tokens){let i=0;const PRECEDENCE={"||":1,"&&":2,"==":3,"!=":3,"===":3,"!==":3,"<":4,">":4,"<=":4,">=":4,"+":5,"-":5,"*":6,"/":6,"%":6};function peek(offset=0){return tokens[i+offset]}function consume(){return tokens[i++]}function match(type,value){const token=peek();return token&&token.type===type&&(!value||token.value===value)}function expect(type,value){const token=consume();if(!token||token.type!==type||value&&token.value!==value)throw new Error(`Expected ${type} '${value}', got ${token?.type} '${token?.value}'`);return token}function parseMemberExpression(expr){for(;!0;)if(match("punctuator",".")){consume();const property=parsePrimary();expr={type:"MemberExpression",object:expr,property,computed:!1}}else if(match("bracket","[")){consume();const property=parseExpression();expect("bracket","]"),expr={type:"MemberExpression",object:expr,property,computed:!0}}else break;return expr}function parseCallee(){const token=peek();if(token.type==="identifier"){const idToken=consume();let expr={type:"Identifier",name:idToken.value};return expr=parseMemberExpression(expr),expr}if(match("paren","(")){consume();const expr=parseExpression();return expect("paren",")"),expr}throw new Error("Expected constructor (identifier or member) after 'new'")}function parsePrimary(){const token=peek();if(!token)throw new Error("Unexpected end of input");if(token.type==="identifier"&&token.value==="new"){consume();const callee=parseCallee();expect("paren","(");const args=[];if(!match("paren",")"))do args.push(parseExpression());while(match("punctuator",",")&&consume())return expect("paren",")"),{type:"NewExpression",callee,arguments:args}}if(match("paren","(")){consume();const expr=parseExpression();return expect("paren",")"),expr}if(match("brace","{"))return parseObjectExpression();if(match("bracket","["))return parseArrayExpression();if(token.type==="number")return consume(),{type:"Literal",value:token.value};if(token.type==="string")return consume(),{type:"Literal",value:token.value};if(match("operator","++")||match("operator","--")){const op=consume().value,argument=parsePrimary();return{type:"UpdateExpression",operator:op,argument,prefix:!0}}if(token.type==="identifier"){consume();let node={type:"Identifier",name:token.value};if(match("operator","++")||match("operator","--")){const op=consume().value;return{type:"UpdateExpression",operator:op,argument:node,prefix:!1}}return node}if(token.type==="operator"&&["!","+","-","~"].includes(token.value)){const op=token.value;consume();const argument=parsePrimary();return{type:"UnaryExpression",operator:op,argument,prefix:!0}}throw new Error(`Unexpected token: ${token.type} ${token.value}`)}function parseMemberAndCall(expr){for(;!0;)if(match("punctuator",".")){consume();const property=parsePrimary();expr={type:"MemberExpression",object:expr,property,computed:!1}}else if(match("bracket","[")){consume();const property=parseExpression();expect("bracket","]"),expr={type:"MemberExpression",object:expr,property,computed:!0}}else if(match("paren","(")){consume();const args=[];if(!match("paren",")"))do args.push(parseExpression());while(match("punctuator",",")&&consume())expect("paren",")"),expr={type:"CallExpression",callee:expr,arguments:args}}else break;return expr}function parseBinaryExpression(minPrecedence=0){let left=parseMemberAndCall(parsePrimary());for(;!0;){const token=peek();if(!token||token.type!=="operator")break;const precedence=PRECEDENCE[token.value];if(precedence===0[0]||precedence<minPrecedence)break;const op=token.value;consume();const right=parseBinaryExpression(precedence+1);left={type:"BinaryExpression",operator:op,left,right}}return left}function parseTernary(){let test=parseBinaryExpression();if(match("punctuator","?")){consume();const consequent=parseExpression();expect("punctuator",":");const alternate=parseExpression();return{type:"ConditionalExpression",test,consequent,alternate}}return test}function parseAssignment(){const left=parseTernary();if(match("operator","=")){const op=consume().value,right=parseAssignment();return{type:"AssignmentExpression",operator:op,left,right}}return left}function parseArrayExpression(){expect("bracket","[");const elements=[];for(;!match("bracket","]");)elements.push(parseExpression()),match("bracket","]")||expect("punctuator",",");return expect("bracket","]"),{type:"ArrayExpression",elements}}function parseObjectExpression(){expect("brace","{");const properties=[];for(;!match("brace","}");){const keyToken=expect("identifier"),key={type:"Identifier",name:keyToken.value};expect("punctuator",":");const value=parseExpression();properties.push({type:"Property",key,value}),match("brace","}")||expect("punctuator",",")}return expect("brace","}"),{type:"ObjectExpression",properties}}function parseExpression(){return parseAssignment()}function parseProgram(){const body=[];for(;i<tokens.length;){const expr=parseExpression();if(body.push(expr),match("semicolon",";"))consume();else break}return{type:"Program",body}}return parseProgram()}kitmodule.ast=kitAST}(typeof window!="undefined"?window:globalThis),function(global){const kitmodule=global.kitmodule||(global.kitmodule={});function kitEvent(root=document){const events=["click","input","change","submit","keydown"];document.addEventListener("click",event=>{const elements=document.querySelectorAll(`[data-kit-click\\:outside]`);elements.forEach(el=>{const raw=el.getAttribute(`data-kit-click:outside`),component=el.$component,exprs=component.$expression(raw);typeof exprs=="string"&&(component.$element.contains(event.target)||component.$evaluator(exprs,el,event))})});for(const type of events)root.addEventListener(type,event=>{event.target.$dispatch(type,event)})}kitmodule.event=kitEvent}(typeof window!="undefined"?window:globalThis),function(global){const kitmodule=global.kitmodule||(global.kitmodule={}),{lexer:kitLexer}=kitmodule;function kitExpression(code){if(!code)return;code.startsWith("{")&&code.endsWith("}")&&(code=code.slice(1,-1).trim(),code=code.replace(/,/g,";"));const tokens=kitLexer(code),result={};let i=0;function next(){return tokens[i++]}function peek(offset=0){return tokens[i+offset]}function parseKey(){const token=next();if(!token)return null;let key="";if(token.type==="string")return token.quote+token.value+token.quote;if(token.type==="number")return token.value;if(token.type==="identifier"){for(key+=token.value;peek()&&["-","_"].includes(peek().value)&&peek(1)&&peek(1).type==="identifier";)key+=next().value,key+=next().value;if(peek()&&peek().value==="("){let depth=0;for(;peek();){const t=peek();if(key+=t.value,t.value==="("?depth++:t.value===")"&&depth--,next(),depth===0)break}}return key}return null}function parseValue(){if(i>=tokens.length)return"";const startToken=tokens[i];let startIndex=startToken.start,depth=0;for(;i<tokens.length;){const t=peek();if(t.value===";"&&depth===0)break;["(","[","{"].includes(t.value)?depth++:[")","]","}"].includes(t.value)&&depth--,next()}const endToken=tokens[i-1];let endIndex=endToken.end;return code.slice(startIndex,endIndex+1)}for(;i<tokens.length;){const key=parseKey();if(!key)break;const colon=next();if(!colon||colon.value!==":")break;const value=parseValue(),separator=peek();separator&&separator.value===";"&&next(),result[key]=value}return result}kitmodule.expression=kitExpression}(typeof window!="undefined"?window:globalThis),function(global){const kitmodule=global.kitmodule||(global.kitmodule={}),{sanitizeHTML:kitSanitize}=kitmodule,types={Program:"Program",Literal:"Literal",Identifier:"Identifier",UnaryExpression:"UnaryExpression",BinaryExpression:"BinaryExpression",AssignmentExpression:"AssignmentExpression",MemberExpression:"MemberExpression",CallExpression:"CallExpression",NewExpression:"NewExpression",ConditionalExpression:"ConditionalExpression",UpdateExpression:"UpdateExpression"},constants={TRUE:!0,FALSE:!1,NULL:null,UNDEFINED:0[0],NAN:NaN,INFINITY:1/0},builtins={Math,Date,Array,Object,Number,String,Boolean,JSON,RegExp,Map,Set,WeakMap,WeakSet,Error,TypeError,RangeError,Promise,URL:class SafeURL extends URL{constructor(path,base){base&&!/^https?:\/\//.test(base)&&(base="https://"+base),super(path,base)}}},funcs={console:{log:console.log.bind(console),warn:console.warn.bind(console),error:console.error.bind(console),info:console.info.bind(console),table:console.table?.bind(console),dir:console.dir?.bind(console),clear:console.clear?.bind(console)},alert:msg=>typeof msg=="string"&&window.alert(kitSanitize(msg)),confirm:msg=>typeof msg=="string"&&window.confirm(kitSanitize(msg)),prompt:window.prompt.bind(window),setTimeout:window.setTimeout.bind(window),setInterval:window.setInterval.bind(window),clearTimeout:window.clearTimeout.bind(window),clearInterval:window.clearInterval.bind(window),parseInt,parseFloat,isNaN,isFinite,encodeURI,decodeURI,encodeURIComponent,decodeURIComponent,escape,unescape},utilities={toUpperCase:str=>typeof str=="string"?str.toUpperCase():str,toLowerCase:str=>typeof str=="string"?str.toLowerCase():str,trim:str=>typeof str=="string"?str.trim():str,slice:(str,start,end)=>typeof str=="string"?str.slice(start,end):str,random:()=>Math.random(),round:n=>typeof n=="number"?Math.round(n):n,floor:n=>typeof n=="number"?Math.floor(n):n,ceil:n=>typeof n=="number"?Math.ceil(n):n,max:Math.max,min:Math.min,abs:Math.abs},safeGlobals={...builtins,...funcs,...utilities,self:{...builtins,...funcs,...utilities}},operators={binary:{"===":(a,b)=>a===b,"!==":(a,b)=>a!==b,"==":(a,b)=>a==b,"!=":(a,b)=>a!=b,">":(a,b)=>a>b,"<":(a,b)=>a<b,">=":(a,b)=>a>=b,"<=":(a,b)=>a<=b,"+":(a,b)=>a+b,"-":(a,b)=>a-b,"*":(a,b)=>a*b,"/":(a,b)=>a/b,"%":(a,b)=>a%b,"&&":(a,b)=>a&&b,"||":(a,b)=>a||b},unary:{"!":a=>!a,"+":a=>+a,"-":a=>-a,"~":a=>~a}};function kitEvaluate(ast,state={},context={}){function getFromContext(name){return constants.hasOwnProperty(name.toUpperCase())?constants[name.toUpperCase()]:safeGlobals.hasOwnProperty(name)?safeGlobals[name]:context.hasOwnProperty(name)?context[name]:state.hasOwnProperty(name)?state[name]:0[0]}function evalNode(node){switch(node.type){case types.Program:let last;for(const expr of node.body)last=evalNode(expr);return last;case types.Literal:return node.value;case types.UpdateExpression:{let oldValue=evalNode(node.argument),newValue=node.operator==="++"?oldValue+1:oldValue-1;return assign(evalNode,node.argument,newValue),node.prefix?newValue:oldValue}case types.Identifier:return getFromContext(node.name);case types.UnaryExpression:return operators.unary[node.operator](evalNode(node.argument));case types.BinaryExpression:return operators.binary[node.operator](evalNode(node.left),evalNode(node.right));case types.AssignmentExpression:return assign(evalNode,node.left,evalNode(node.right));case types.MemberExpression:{if(node.property.type===types.UpdateExpression){const obj=evalNode(node.object);if(obj==null)throw new Error(`Cannot read property of ${obj}`);const prop=node.property.argument.name,oldVal=obj[prop],newVal=node.property.operator==="++"?oldVal+1:oldVal-1;return obj[prop]=newVal,node.property.prefix?newVal:oldVal}const obj=evalNode(node.object);if(obj==null)throw new Error(`Cannot read property of ${obj}`);const prop=node.computed?evalNode(node.property):node.property.name;return obj[prop]}case types.CallExpression:{const calleeNode=node.callee;let fn,thisArg;if(calleeNode.type===types.MemberExpression){thisArg=evalNode(calleeNode.object);const prop=calleeNode.computed?evalNode(calleeNode.property):calleeNode.property.name;fn=thisArg?.[prop]}else fn=evalNode(calleeNode),thisArg=context?.this||null;if(typeof fn!="function")throw new Error("CallExpression: callee is not a function");const args=node.arguments.map(evalNode);return fn.apply(thisArg,args)}case types.NewExpression:{const ctor=evalNode(node.callee);if(typeof ctor!="function")throw new Error("NewExpression: callee is not a constructor");const args=node.arguments.map(evalNode);return new ctor(...args)}case types.ConditionalExpression:return evalNode(evalNode(node.test)?node.consequent:node.alternate);default:throw new Error(`Unknown AST node type: ${node.type}`)}}function assign(evalNode,target,value){if(target.type===types.Identifier)return state[target.name]=value,value;if(target.type===types.MemberExpression){const obj=evalNode(target.object);if(obj==null)throw new Error(`Cannot set property of ${obj}`);const prop=target.computed?evalNode(target.property):target.property.name;return obj[prop]=value,value}throw new Error("Invalid assignment target")}return evalNode(ast)}kitmodule.evaluate=kitEvaluate}(typeof window!="undefined"?window:globalThis),function(global){const kitmodule=global.kitmodule||(global.kitmodule={}),{lexer:kitLexer,ast:kitAST,evaluate:kitEvaluate}=kitmodule;function kitCompile(expr){const tokens=kitLexer(expr),ast=kitAST(tokens);function getter(state={},context={}){return kitEvaluate(ast,state,context)}return ast.type==="AssignmentExpression"&&(getter.assign=(state,value,context={})=>{const right=ast.right,originalRight=right;ast.right={type:"Literal",value};const result=kitEvaluate(ast,state,context);return ast.right=originalRight,result}),getter}kitmodule.compile=kitCompile}(typeof window!="undefined"?window:globalThis),function(global){const kitmodule=global.kitmodule||(global.kitmodule={}),{sanitizeHTML:kitSanitizer}=kitmodule;function kitDirective(component){return{if(el,expr,extra={}){if(extra&&extra.update)return;const parent=el.parentNode,placeholder=document.createComment("kit:if");el.removeAttribute(component.$directive("if"));const template=el.cloneNode(!0);parent.insertBefore(placeholder,el),el.remove();let currentNode=null;component.$addEffect(placeholder,()=>{const shouldShow=!!component.$evaluator(expr,placeholder,null,extra);if(shouldShow&&!currentNode){const node=template.cloneNode(!0);parent.insertBefore(node,placeholder.nextSibling),currentNode=node,component.$binding(node,"if",extra)}else!shouldShow&&currentNode&&(component.$cleanup(currentNode),currentNode.remove(),currentNode=null)})},for(el,expr,extra={}){const exprs=component._parseExpr(expr).trim();if(!exprs)return;el.removeAttribute(component.$directive("for"));const template=el.cloneNode(!0),parent=el.parentNode,startPlaceholder=document.createComment("kit:for"),endPlaceholder=document.createComment("/kit:for");var implicit,nextElement=el.nextElementSibling,nextIndex=nextElement?.getAttribute("data-kit-index");parent.insertBefore(startPlaceholder,el),nextIndex||parent.insertBefore(endPlaceholder,el);var list=[];switch(typeof exprs){case"string":/\s/g.test(exprs)?(implicit=parseForExpression(exprs),implicit.$items?list=component.$evaluator(implicit.$items,el,null,extra):console.err("Invalid for expression: missing items",el,expr)):list=component.$evaluator(exprs,el,null,extra);break;case"object":list=component.$evaluator(exprs.items,el,null,extra);break}const nodeMap=new Map,$idx=Symbol("index"),$key=Symbol("key"),indexMap=new Map;for(component.$addEffect(endPlaceholder,()=>{const newKeys=new Set,removeIndexes=[];var isDuplicate;if(!list)return;list.forEach((item,index)=>{if(item===0[0])return;let key;if(typeof item=="object")item[$idx]=index,key=item[$key]=item[implicit.$key]??item.id??item.node??null;else{if(isDuplicate=toBoolean(implicit.$duplicate),isDuplicate)key=item+"_"+index;else if(key=item,newKeys.has(key)){delete list[index],removeIndexes.push(index);return}indexMap.set(key,index)}let node=nodeMap.get(key);if(newKeys.add(key),!node){node=template.content?template.content.cloneNode(!0):template.cloneNode(!0);const nextItem=list[index+1];typeof nextItem=="object"?nextKey=nextItem[$key]:isDuplicate?nextKey=nextItem+"_"+index+1:newKeys.has(nextItem)||(nextKey=nextItem);const nextNode=nextKey?nodeMap.get(nextKey):endPlaceholder,insertNode=nextNode||endPlaceholder;parent?.insertBefore(node,insertNode),nodeMap.set(key,node);var nextKey,extra={$item:item};Object.defineProperty(node,"$extra",{enumerable:!0,configurable:!0,get(){return extra},set(val){extra=val}}),Object.defineProperty(extra,"$index",{enumerable:!0,get(){const i=this.$item;return typeof i=="object"?i[$idx]:indexMap.get(key)}}),Object.defineProperty(extra,"$count",{enumerable:!0,get(){return list.length}}),Object.defineProperty(extra,"$first",{enumerable:!0,get(){return this.$index===0}}),Object.defineProperty(extra,"$even",{enumerable:!0,get(){return this.$index%2===0}}),Object.defineProperty(extra,"$odd",{enumerable:!0,get(){return this.$index%2===1}});for(const[k,v]of Object.entries(implicit))switch(k){case"$item":Object.defineProperty(extra,v,{enumerable:!0,configurable:!0,get(){return this.$item},set(val){this.$item=val}});break;case"$index":case"$count":case"$first":case"$even":case"$odd":Object.defineProperty(extra,v,{enumerable:!0,get(){return this[k]}});break}component.$binding(node,"for",extra)}node.setAttribute("data-kit-index",index)});for(let i=removeIndexes.length-1;i>=0;i--)list.splice(removeIndexes[i],1);Array.from(nodeMap.keys()).forEach(key=>{if(!newKeys.has(key)){const node=nodeMap.get(key);component.$cleanup(node),parent.removeChild(node),nodeMap.delete(key)}})});nextIndex;){if(!nextIndex)break;var index=Number(nextIndex);itemElement=nextElement.querySelector(`[data-kit-sync="item"]`);var item=itemElement.value;const key=item+"_"+index;nodeMap.set(key,nextElement),list[index]=item;const extra={$item:list[index]};Object.defineProperty(nextElement,"$extra",{enumerable:!0,configurable:!0,get(){return extra},set(val){extra=val}}),Object.defineProperty(extra,"$index",{enumerable:!0,get(){return index}}),Object.defineProperty(extra,"$count",{enumerable:!0,get(){return list.length}}),Object.defineProperty(extra,"$first",{enumerable:!0,get(){return this.$index===0}}),Object.defineProperty(extra,"$even",{enumerable:!0,get(){return this.$index%2===0}}),Object.defineProperty(extra,"$odd",{enumerable:!0,get(){return this.$index%2===1}});for(const[k,v]of Object.entries(implicit))switch(k){case"$item":Object.defineProperty(extra,v,{enumerable:!0,configurable:!0,get(){return this.$item},set(val){this.$item=val}});break;case"$index":case"$count":case"$first":case"$even":case"$odd":Object.defineProperty(extra,v,{enumerable:!0,get(){return this[k]}});break}component.$binding(nextElement,"for",extra);const next=nextElement?.nextElementSibling;if(nextIndex=next.getAttribute("data-kit-index"),!nextIndex)break;nextElement=next}parent.insertBefore(startPlaceholder,el),parent.insertBefore(endPlaceholder,nextIndex?nextElement?.nextSibling:el),el.remove()},show(el,expr,extra={}){const exprs=el.$show;component.$addEffect(el,()=>{el.hidden=!component.$evaluator(exprs,el,null,extra)})},class(el,expression,extra={}){const exprs=el.$class;component.$addEffect(el,()=>{if(!exprs)return;if(typeof exprs=="string"){const add=component.$evaluator(exprs,el,null,extra);add&&el.classList.add(add);const remove=component.$evaluator(reverseTernary(exprs),el,null,extra);remove&&el.classList.remove(remove);return}if(typeof exprs=="object")for(const[cls,cond]of Object.entries(exprs))el.classList.toggle(cls,!!component.$evaluator(cond,el,null,extra))})},style(el,expression,extra={}){component.$addEffect(el,()=>{const exprs=el.$style;if(!exprs||typeof exprs!="object")return;for(let[prop,val]of Object.entries(exprs)){prop=prop.replace(/^['"](.*)['"]$/,"$1").trim();const value=component.$evaluator(val,el,null,extra);el.$setStyle(prop,value)}})},bind(el,expression,extra={}){const exprs=el.$bind;component.$addEffect(el,()=>{if(!exprs)return;if(typeof exprs=="string"){el.$value=component.$evaluator(exprs,el,null,extra);return}if(typeof exprs=="object")for(const[prop,val]of Object.entries(exprs)){const value=component.$evaluator(val,el,null,extra);el.$setValue(value,prop)}})},model(el,expr,extra={}){const exprs=component._parseExpr(expr);if(!exprs)return;if(typeof exprs=="string"){const tag=el.tagName.toLowerCase();switch(tag){case"input":case"textarea":case"select":el.value=component.$evaluator(exprs,el,null,extra),el.addEventListener("input",()=>{["checkbox","radio"].includes(el.type)?Object.keys(extra).length>0?deepSet(extra,exprs,el.checked):component.$scope[exprs]=el.checked:Object.keys(extra).length>0?deepSet(extra,exprs,el.value):component.$scope[exprs]=el.value});break}}component.$addEffect(el,()=>{if(typeof exprs=="string"){const val=component.$evaluator(exprs,el,null,extra);el.$value!==val&&(el.$value=val)}})},sync(el,expr,extra={}){const exprs=component._parseExpr(expr);if(!exprs)return;if(typeof exprs=="string"){const tag=el.tagName.toLowerCase(),domValue=(()=>{switch(tag){case"input":case"textarea":case"select":return["checkbox","radio"].includes(el.type)?el.checked:el.value;default:return el.textContent?.trim?.()??""}})();switch(domValue!=null&&(Object.keys(extra).length>0?deepSet(extra,exprs,domValue):component.$scope[exprs]=domValue),tag){case"input":case"textarea":case"select":el.addEventListener("input",()=>{["checkbox","radio"].includes(el.type)?Object.keys(extra).length>0?deepSet(extra,exprs,el.checked):component.$scope[exprs]=el.checked:Object.keys(extra).length>0?deepSet(extra,exprs,el.value):component.$scope[exprs]=el.value});break}}component.$addEffect(el,()=>{if(typeof exprs=="string"){const val=component.$evaluator(exprs,el,null,extra);el.$value=val}})}}}function deepSet(obj,path,value){const keys=path.split("."),lastKey=keys.pop(),target=keys.reduce((acc,key)=>(acc[key]===0[0]&&(acc[key]={}),acc[key]),obj);return target[lastKey]=value}function reverseTernary(expr){const match=expr.match(/^(.*?)\?(.*?):(.*)$/);if(!match)return null;let[,condition,truthy,falsy]=match;return`!(${condition.trim()}) ? ${truthy.trim()} : ${falsy.trim()}`}function toBoolean(value){if(value==null)return!1;if(typeof value=="boolean")return value;const val=String(value).trim().toLowerCase();return!["false","0","null","undefined","no","off",""].includes(val)}function parseForExpression(expr){const result={},[loopPart,...aliasParts]=expr.split(";").map(s=>s.trim());let item,index,collection,m=loopPart.match(/^(?:let\s+)?\(([^)]+)\)\s+(?:in|of)\s+(.+)$/);if(m){const vars=m[1].split(",").map(s=>s.trim());item=vars[0],index=vars[1],collection=m[2]}return m||(m=loopPart.match(/^(?:let\s+)?(\w+)(?:\s*,\s*(\w+))?\s+(?:in|of)\s+(.+)$/),m&&(item=m[1],index=m[2],collection=m[3])),m||(m=loopPart.match(/^(\w+)\s+(?:in|of)\s+(.+)$/),m&&(item=m[1],collection=m[2])),item&&(result.$item=item),index&&(result.$index=index),collection&&(result.$items=collection.trim()),aliasParts.forEach(part=>{let m;if(m=part.match(/^let\s+(\w+)\s*=\s*(\$\w+)$/),m){const[,alias,meta]=m;result[meta]=alias;return}if(m=part.match(/^(\w+)\s+as\s+(\$\w+)$/),m){const[,alias,meta]=m;result[meta]=alias}if(m=part.match(/^(\$\w+)\s*=\s*(\w+)$/),m){const[,meta,alias]=m;result[meta]=alias;return}}),result}function invertObject(obj){const result={};for(const[k,v]of Object.entries(obj))result[v]=k;return result}kitmodule.directive=kitDirective}(typeof window!="undefined"?window:globalThis),function(global){const kitmodule=global.kitmodule||(global.kitmodule={});function kitReactive(){const bucket=new WeakMap;let activeEffect=null,shouldTrack=!0;const jobQueue=new Set;let isFlushing=!1;function schedule(job){jobQueue.add(job),isFlushing||(isFlushing=!0,Promise.resolve().then(()=>{jobQueue.forEach(fn=>fn()),jobQueue.clear(),isFlushing=!1}))}const ITERATE_KEY=Symbol("iterate"),originalToProxy=new WeakMap,proxyToRaw=new WeakMap;function track(target,key){if(!activeEffect||!shouldTrack)return;let depsMap=bucket.get(target);depsMap||(depsMap=new Map,bucket.set(target,depsMap));let deps=depsMap.get(key);deps||(deps=new Set,depsMap.set(key,deps)),deps.has(activeEffect)||(deps.add(activeEffect),activeEffect.deps.push(deps))}function trigger(target,key){const depsMap=bucket.get(target);if(!depsMap)return;const deps=depsMap.get(key);if(!deps)return;const effectsToRun=new Set(deps);effectsToRun.forEach(effectFn=>{effectFn.scheduler?effectFn.scheduler(effectFn):effectFn()})}function cleanup(effectFn){for(const dep of effectFn.deps)dep.delete(effectFn);effectFn.deps.length=0}function effect(fn,options={}){const effectFn=()=>{cleanup(effectFn),activeEffect=effectFn;const result=fn();return activeEffect=null,result};return effectFn.deps=[],effectFn.scheduler=options.scheduler,effectFn.cleanup=()=>{cleanup(effectFn)},options.lazy||effectFn(),effectFn}const arrayInstrumentations=Object.create(null);["push","pop","shift","unshift","splice","sort","reverse"].forEach(method=>{arrayInstrumentations[method]=function(...args){const raw=proxyToRaw.get(this)||this;shouldTrack=!1;const res=Array.prototype[method].apply(raw,args);return shouldTrack=!0,trigger(raw,ITERATE_KEY),trigger(raw,"length"),res}});function reactive(obj,cache=new WeakMap){if(typeof obj!="object"||obj===null)return obj;if(originalToProxy.has(obj))return originalToProxy.get(obj);if(cache.has(obj))return cache.get(obj);const proxy=new Proxy(obj,{get(target,key,receiver){if(key==="__isReactive")return!0;if(Array.isArray(target)&&Object.prototype.hasOwnProperty.call(arrayInstrumentations,key))return arrayInstrumentations[key].bind(receiver);const res=Reflect.get(target,key,receiver);return track(target,key),Array.isArray(target)&&key===Symbol.iterator?function*(){track(target,ITERATE_KEY);for(let i=0;i<target.length;i++)track(target,String(i)),yield reactive(target[i],cache)}:typeof res=="object"&&res!==null?reactive(res,cache):res},set(target,key,value,receiver){const oldVal=target[key],hadKey=Object.prototype.hasOwnProperty.call(target,key),result=Reflect.set(target,key,value,receiver);return hadKey||trigger(target,ITERATE_KEY),oldVal!==value&&(trigger(target,key),Array.isArray(target)&&key==="length"&&trigger(target,ITERATE_KEY)),result},deleteProperty(target,key){const hadKey=Object.prototype.hasOwnProperty.call(target,key),result=Reflect.deleteProperty(target,key);return hadKey&&(trigger(target,ITERATE_KEY),trigger(target,key)),result}});return originalToProxy.set(obj,proxy),proxyToRaw.set(proxy,obj),cache.set(obj,proxy),proxy}function computed(getter){let value,dirty=!0,dep=new Set;const runner=effect(getter,{lazy:!0,scheduler:()=>{dirty=!0,dep.forEach(effectFn=>effectFn())}}),computedRef={get value(){return activeEffect&&dep.add(activeEffect),dirty&&(value=runner(),dirty=!1),value}};return computedRef}function watch(source,callback,options={}){let getter=typeof source=="function"?source:()=>source,oldValue,cleanupFn;function onCleanup(fn){cleanupFn=fn}const job=()=>{cleanupFn&&cleanupFn();const newValue=runner();callback(newValue,oldValue,onCleanup),oldValue=newValue},runner=effect(()=>getter(),{lazy:!0,scheduler:()=>schedule(job)});return options.immediate?job():oldValue=runner(),()=>cleanup(runner)}function mirror(proxyArray){if(!Array.isArray(proxyArray))return proxyArray;const arr=proxyArray,mirrorer=reactive([]);function syncMirror(){mirrorer.length=arr.length;for(let i=0;i<arr.length;i++)mirrorer[i]||(mirrorer[i]=reactive({get value(){return arr[i]},set value(v){arr[i]=v}}))}return effect(syncMirror),mirrorer}function stop(runner){cleanup(runner)}return{reactive,effect,computed,watch,stop,mirror}}kitmodule.reactive=kitReactive}(typeof window!="undefined"?window:globalThis),function(global){const kitmodule=global.kitmodule||(global.kitmodule={}),{sanitizeHTML:kitSanitizer,expression:kitExpression}=kitmodule;function kitElement(context){Object.defineProperty(Element.prototype,"$marker",{get(){return context.marker},configurable:!0,enumerable:!1}),Object.defineProperty(Element.prototype,"$html",{get(){return this.innerHTML},set(val){this.innerHTML=kitSanitizer(val)},configurable:!0,enumerable:!1}),Object.defineProperty(Element.prototype,"$text",{get(){return this.textContent?.trim?.()??""},set(val){this.textContent=val},configurable:!0,enumerable:!1}),Object.defineProperty(Element.prototype,"$getValue",{value:function(target){const tag=target||this.tagName.toLowerCase();switch(tag){case"input":case"textarea":case"select":switch(this.type){case"checkbox":case"radio":return this.checked;default:return this.value}case"img":return this.src;case"a":return this.href;default:return this.$text}},enumerable:!0,writable:!1,configurable:!1}),Object.defineProperty(Element.prototype,"$setValue",{value:function(value,target){if(target){switch(target){case"text":this.$text=value;return;case"html":this.$html=value;return;default:if(!value){this.removeAttribute(target);return}this.setAttribute(target,value);break}return}const tag=this.tagName.toLowerCase();switch(tag){case"input":case"textarea":case"select":switch(this.type){case"checkbox":case"radio":this.checked=Boolean(value);return;default:this.value=value;return}return;case"img":this.src=value;return;case"a":this.href=value;return;default:this.$text=value;return}},enumerable:!0,writable:!1,configurable:!1}),Object.defineProperty(Element.prototype,"$value",{get(){return this.$getValue()},set(val){this.$setValue(val)},configurable:!0,enumerable:!1}),Object.defineProperty(Element.prototype,"$directive",{value:function(name){return context.directive(name)},configurable:!0,enumerable:!1}),Object.defineProperty(Element.prototype,"$variants",{value:function(name){const base=this.$directive(name),variants=[],modifierKeywords=new Set(["once","stop","prevent","capture","passive","window","document","outside","throttle","debounce"]);for(const attr of this.attributes){if(attr.name!==base&&!attr.name.startsWith(base+":"))continue;const parts=attr.name.split(":").slice(1),item={variant:null,debounce:null,throttle:null,once:!1,stop:!1,prevent:!1,capture:!1,passive:!1,scope:null,attribute:attr.name,value:attr.value};let iStart=0;if(parts.length>0){const first=parts[0],isNumber=/^\d+$/.test(first),isMs=/^\d+ms$/.test(first),isModifier=modifierKeywords.has(first);!isNumber&&!isMs&&!isModifier?(item.variant=first,iStart=1):iStart=0}for(let i=iStart;i<parts.length;i++){const p=parts[i];if(/^\d+$/.test(p)){item.debounce=parseInt(p,10);continue}if(/^\d+ms$/.test(p)){item.debounce=parseInt(p.replace(/ms$/,""),10);continue}switch(p){case"once":item.once=!0;break;case"stop":item.stop=!0;break;case"prevent":item.prevent=!0;break;case"capture":item.capture=!0;break;case"passive":item.passive=!0;break;case"window":case"document":case"outside":item.scope=p;break;case"throttle":{const next=parts[i+1];next&&/^\d+$/.test(next)?(item.throttle=parseInt(next,10),i++):next&&/^\d+ms$/.test(next)?(item.throttle=parseInt(next.replace(/ms$/,""),10),i++):item.throttle=!0;break}case"debounce":{const next=parts[i+1];next&&/^\d+$/.test(next)?(item.debounce=parseInt(next,10),i++):next&&/^\d+ms$/.test(next)?(item.debounce=parseInt(next.replace(/ms$/,""),10),i++):item.debounce=!0;break}default:break}}variants.push(item)}return variants},enumerable:!0,writable:!1,configurable:!1}),Object.defineProperty(Element.prototype,"$exist",{value:function(name){const directive=this.$directive(name);return this.hasAttribute(directive)},enumerable:!0,writable:!1,configurable:!1}),Object.defineProperty(Element.prototype,"$has",{value:function(name){const directive=this.$directive(name);return this.hasAttribute(directive)},enumerable:!0,writable:!1,configurable:!1}),Object.defineProperty(Element.prototype,"$get",{value:function(name){const directive=this.$directive(name);return this.getAttribute(directive)},enumerable:!0,writable:!1,configurable:!1}),Object.defineProperty(Element.prototype,"$set",{value:function(name,value){const directive=this.$directive(name);return this.setAttribute(directive,value)},enumerable:!0,writable:!1,configurable:!1}),Object.defineProperty(Element.prototype,"$remove",{value:function(name){this.removeAttribute(this.$directive(name))},enumerable:!0,writable:!1,configurable:!1}),Object.defineProperty(Element.prototype,"$owner",{value:function(name){const selector=this.$selector(name);return this.closest(selector)},enumerable:!0,writable:!1,configurable:!1}),Object.defineProperty(Element.prototype,"$within",{value:function(element,name){return this.$owner(name)===element},enumerable:!0,writable:!1,configurable:!1}),Object.defineProperty(Element.prototype,"$manager",{get(){return this.$owner()},configurable:!0,enumerable:!1}),Object.defineProperty(Element.prototype,"$selector",{value:function(...names){return names.map(dir=>context.selector(dir)).join(", ")},enumerable:!0,writable:!1,configurable:!1}),Object.defineProperty(Element.prototype,"$isComponent",{get(){return this.$has()},configurable:!0,enumerable:!1}),Object.defineProperty(Element.prototype,"$component",{get(){const manager=this.$isComponent?this:this.$manager;return manager?context.instances.get(manager):null},configurable:!0,enumerable:!1}),Object.defineProperty(Element.prototype,"$state",{get(){const component=this.$component;return component?component.$state:0[0]},set(val){const component=this.$component;component&&(component.$state=val)},configurable:!0,enumerable:!1}),Object.defineProperty(Element.prototype,"$extra",{get(){const root=this.closest(`[data-kit-index]`);return root?root?.$extra:{}},configurable:!0,enumerable:!1}),Object.defineProperty(Element.prototype,"$parent",{get(){return context.parent(this)},configurable:!0,enumerable:!1}),Object.defineProperty(Element.prototype,"$dataset",{get(){const result={},marker=this.$marker+"-";for(const attr of this.getAttributeNames())if(attr.startsWith(marker)){const shortKey=attr.slice(marker.length),shortKeySplit=shortKey.split("-"),finalKey=shortKeySplit.map((part,i)=>i===0?part:part.charAt(0).toUpperCase()+part.slice(1)).join("");result[finalKey]=this.getAttribute(attr)}return result},configurable:!0,enumerable:!1}),Object.defineProperty(Element.prototype,"$find",{value:function(name){return this.querySelector(context.selector(name))||null},enumerable:!0,writable:!1,configurable:!1}),Object.defineProperty(Element.prototype,"$finds",{value:function(name){return this.querySelectorAll(context.selector(name))||[]},enumerable:!0,writable:!1,configurable:!1}),Object.defineProperty(Element.prototype,"$scan",{value:function(...names){return Array.from(this.querySelectorAll(this.$selector(...names))).filter(el=>el.$within(this))},enumerable:!0,writable:!1,configurable:!1}),Object.defineProperty(Element.prototype,"$walk",{value:function(callback){let node=this.firstElementChild;for(;node;)callback(node)!==!1&&node.$walk(callback,!0),node=node.nextElementSibling},enumerable:!1,writable:!1,configurable:!1}),Object.defineProperty(Element.prototype,"$expression",{value:function(name){if(!name)return;const value=this.$get(name),result=kitExpression(value);return result&&Object.keys(result).length===0?value:result},enumerable:!1,writable:!1,configurable:!1}),Object.defineProperty(Element.prototype,"$evaluate",{value:function(expression,event,extra,component){component||(component=this.$component),component&&component.$evaluator(expression,this,event,extra)},enumerable:!1,writable:!1,configurable:!1}),Object.defineProperty(Element.prototype,"$dispatch",{value:function(type,event){let current=this;for(;current&&current!==document.documentElement;){if(current.nodeType!==1){current=current.parentElement;continue}const items=current.$variants(type);for(const item of items){const key=event.key?.toLowerCase?.(),variant=item.variant?.toLowerCase?.()??null;console.log(item);const match=variant===null||variant&&key&&variant===key;if(!match)continue;item.stop&&event.stopPropagation(),item.prevent&&event.preventDefault(),item.once&&current.removeAttribute(item.attribute),current.$evaluate(item.value,event,{})}current=current.parentElement}},enumerable:!1,writable:!1,configurable:!1}),Object.defineProperty(Element.prototype,"$eval",{value:function(name){const expression=this.$expression(name);if(!expression)return;const component=this.$component;if(!component)return;return component.$evaluator(expression,this)},enumerable:!0,writable:!1,configurable:!1}),Object.defineProperty(Element.prototype,"$show",{get(){return this.$expression("show")},configurable:!0,enumerable:!1}),Object.defineProperty(Element.prototype,"$bind",{get(){return this.$expression("bind")},configurable:!0,enumerable:!1}),Object.defineProperty(Element.prototype,"$style",{get(){return this.$expression("style")},configurable:!0,enumerable:!1}),Object.defineProperty(Element.prototype,"$class",{get(){return this.$expression("class")},configurable:!0,enumerable:!1}),Object.defineProperty(Element.prototype,"$sync",{get(){return this.$expression("sync")},configurable:!0,enumerable:!1}),Object.defineProperty(Element.prototype,"$setStyle",{value:function(name,value){if(value==null||value===""){this.style.removeProperty(name);return}if(!name.includes("-")){this.style[name]=value;return}this.style.setProperty(name,value)},enumerable:!0,writable:!1,configurable:!1}),Object.defineProperty(Element.prototype,"$destroy",{value:function(){},enumerable:!0,writable:!1,configurable:!1})}kitmodule.element=kitElement}(typeof window!="undefined"?window:globalThis),function(global){const kitmodule=global.kitmodule||(global.kitmodule={}),{reactive:kitReactive,directive:kitDirective,expression:kitExpression,compile:kitCompile}=kitmodule;function KitComponent(element,options,context){const{prefix,attribute,symbol,kit}=context;this.$symbol=symbol,this[symbol]={},this.$addSymbol("context",context),this.$addSymbol("name",context.name(element)),this.$addSymbol("attribute",attribute),this.$addSymbol("element",element),this.$addSymbol("prefix",prefix),this.$addSymbol("kit",kit),this.$addSymbol("options",normalizeOptions(options)),this.$addSymbol("dataset",extractDataset(element,kit,prefix)),this.$addSymbol("parent",context.parent(element)),this.$addSymbol("alias",alias(element,attribute)||this.$dataset.alias),this.$addSymbol("directives",kitDirective(this)),this.$addSymbol("itself",itSelf(this)),this.$extras=new WeakMap,this.$compiles=new Map,this.$binded=new Map,this.$methods={},this.$deriveds={};var{state,methods,deriveds}=this.$options;if(this.$dataset.hasOwnProperty("state")){var stateData=this._parseExpr(this.$dataset.state);if(stateData&&typeof stateData=="object"){for(const key in stateData)stateData[key]=this.$evaluator(stateData[key]);state={...state,...stateData}}}for(const key in this.$dataset){const stateString="state";if(key!==stateString&&key.startsWith(stateString)){const rawKey=key.slice(stateString.length),prop=rawKey.charAt(0).toLowerCase()+rawKey.slice(1);let value=this.$evaluator(this.$dataset[key]);state[prop]=value}}const{reactive,effect,stop,watch,computed,mirror}=kitReactive();this.$reactive=reactive,this.$computed=computed,this.$effect=effect,this.$stop=stop,this.$mirror=mirror,this.$scope=reactive(state);for(const key in methods)if(typeof methods[key]=="function"){const method=methods[key].bind(this);this.$methods[key]=method,Object.defineProperty(this.$scope,key,{value:method,enumerable:!0,writable:!1,configurable:!1})}for(const key in deriveds){const desc=deriveds[key],target=desc.value||desc.get;if(typeof target=="function"){this.$deriveds[key]=target;const c=this.$computed(()=>target.call(this.$scope));Object.defineProperty(this.$scope,key,{enumerable:!0,configurable:!0,get(){return c.value}})}}for(const key in state)Object.defineProperty(this,key,{get:()=>this.$scope[key],set:value=>{this.$scope[key]=value}});if(this.$parent){const parent=this.$parent;this.$scope.$parent={};for(const key in parent.$scope){if(parent.$deriveds.hasOwnProperty(key)){const c=this.$computed(()=>parent.$deriveds[key].call(this.$scope.$parent));Object.defineProperty(this.$scope.$parent,key,{enumerable:!0,configurable:!0,get(){return c.value}});continue}if(typeof parent.$scope[key]=="function"){const func=parent.$scope[key];Object.defineProperty(this.$scope.$parent,key,{value:func,enumerable:!0,writable:!1,configurable:!1});continue}}parent.$effect(()=>{for(const key in parent.$scope){if(key.startsWith("$"))return;if(!parent.$deriveds.hasOwnProperty(key)){const val=parent.$scope[key];val!==0[0]&&typeof val!="function"&&!parent.$deriveds.hasOwnProperty(key)&&this.$scope.$parent[key]!=val&&(this.$scope.$parent[key]=val)}}}),this.$effect(()=>{for(const key in parent.$scope){if(key.startsWith("$"))return;const val=this.$scope.$parent[key];val!==0[0]&&typeof val!="function"&&!parent.$deriveds.hasOwnProperty(key)&&parent.$scope[key]!=val&&(parent.$scope[key]=val)}})}this.$destroyed=!1,this.$binding(element)}Object.defineProperty(KitComponent.prototype,"$state",{enumerable:!0,configurable:!0,get(){return this.$scope},set(val){this.$scope=val}}),Object.defineProperty(KitComponent.prototype,"$state",{get:function(){return this._refs}}),KitComponent.prototype.$addEffect=function(element,func){const effect=this.$effect(func);this.$binder(element).effects.push(effect)},KitComponent.prototype.$binder=function(element,extra=null){return this.$binded.has(element)||this.$binded.set(element,{events:[],effects:[],extra}),this.$binded.get(element)},KitComponent.prototype.$addEffect=function(element,func){const effect=this.$effect(func);this.$binder(element).effects.push(effect)},KitComponent.prototype.$addEvent=function(element,type,handler){this.$binder(element).events.push({type,handler})},KitComponent.prototype.$binding=function(element,skip=!1,extra={}){this.$finds(element).forEach(el=>{if(!this.$element.contains(el))return;for(const[directive,handler]of Object.entries(this.$directives)){if(skip&&directive===skip)continue;const attr=this.$directive(directive),expr=el.getAttribute(attr);expr!=null&&handler(el,expr,extra)}})},KitComponent.prototype.$cleanup=function(element){const list=Array.from(this.$finds(element));list.includes(element)||list.push(element),list.forEach(el=>{const binder=this.$binder(el);if(!binder)return;binder.effects.forEach(effect=>this.$stop(effect)),binder.events.forEach(({type,handler})=>{switch(type){case"intersect":handler.disconnect?.();break;default:el.removeEventListener(type,handler)}});let test=this.$binded.delete(el)})},KitComponent.prototype.$finds=function(element,isChild=!0){if(!element)return[];const selector=Object.keys(this.$directives).map(dir=>this.$selector(dir)).join(", ");let candidates=Array.from(element.querySelectorAll(selector));return element.matches(selector)&&candidates.push(element),isChild===!1?candidates:candidates.filter(el=>{const parentComp=el.closest(this.$context.selector());return parentComp===this.$element})},KitComponent.prototype.$event=function(){},KitComponent.prototype.$addSymbol=function(key,value){const symbol=this.$symbol;this[symbol][key]=value,Object.defineProperty(KitComponent.prototype,"$"+key,{get:function(){return this[symbol][key]},configurable:!0})},Object.defineProperty(KitComponent.prototype,"$refs",{get:function(){return this._refs&&this._refs.size>0?this._refs:(this._refs=this.$collect("ref"),this._refs)}}),KitComponent.prototype.$ref=function(key){return this.$refs.get(key)||null},Object.defineProperty(KitComponent.prototype,"$items",{get:function(){return this._items&&this._items.size>0?this._items:(this._items=this.$collect("item"),this._items)}}),KitComponent.prototype.$item=function(key){return this.items.get(key)||null},KitComponent.prototype.$collection=function(directive){return Object.fromEntries(this.$collect(directive))},KitComponent.prototype.$collect=function(directive,target){const result=new Map,elements=this.$references(directive,target),attribute=this.$directive(directive);return elements.forEach(item=>{const key=item.getAttribute(attribute);result.set(key,item)}),result},KitComponent.prototype.$references=function(directive,target){const selector=this.$selector(directive,target);return this.$element.querySelectorAll(selector)||[]},KitComponent.prototype.$directive=function(dir){return[this.$prefix,this.$kit,dir].filter(Boolean).join("-")},KitComponent.prototype.$selector=function(dir,target){const attr=this.$directive(dir);return target?`[${attr}=${target}]`:`[${attr}]`},KitComponent.prototype.$expression=function(expr){let result=kitExpression(expr);return Object.keys(result).length===0?expr:result},KitComponent.prototype._parseExpr=function(expr){let result=kitExpression(expr);return Object.keys(result).length===0?expr:result},KitComponent.prototype.$compile=function(expr){return this.$compiles.has(expr)||this.$compiles.set(expr,kitCompile(expr)),this.$compiles.get(expr)},KitComponent.prototype.$evaluator=function(expr,element=null,event=null,extra={}){try{if(!expr)return;let expression=expr.trim();const fn=this.$compile(expression);Object.keys(extra).length===0&&(extra=element?.$extra,console.log);const context={$event:event,$element:element,...extra};return typeof fn.assign=="function"&&/=/.test(cacheKey)?fn.assign(this.$scope,extra.value,context):fn(this.$scope,context)}catch(err){return console.error("[kitComponent._eval] Error evaluating expression:",expr,err),0[0]}},KitComponent.prototype._handleOutside=function(expr,exceptions=[],node){const whitelist=Array.from(new Set(exceptions)),handler=e=>{const target=e.target,isInside=whitelist.some(el=>el.contains(target));if(isInside)return;this.$evaluator(expr,node,e)};document.addEventListener("click",handler),this.$addEvent(document,"click",handler)},KitComponent.prototype._handleIntersect=function(expr,type,el){if(!el)return;const mapType={appear:{event:"enter",once:!0},intersect:{event:"enter",once:!1},leave:{event:"leave",once:!1},exit:{event:"leave",once:!0}},typeInfo=mapType[type];if(!typeInfo)return;const observer=new IntersectionObserver((entries,obs)=>{entries.forEach(entry=>{const isEnter=entry.isIntersecting,isLeave=!entry.isIntersecting;(typeInfo.event==="enter"&&isEnter||typeInfo.event==="leave"&&isLeave)&&(this.$evaluator(expr,el),typeInfo.once&&obs.unobserve(el))})},{threshold:0});observer.observe(el),this.$addEvent(el,"intersect",observer)},KitComponent.prototype._kitDestroy=function(){if(this._destroyed)return;this._destroyed=!0,this._events.forEach(({node,event,handler})=>{switch(event){case"intersect":handler.disconnect?.();break;default:node.removeEventListener(event,handler)}}),this._events=[],typeof this.$effect.cleanup=="function"&&this.$effect.cleanup(),this.$element._kits?.delete(this.$name),this.$element=null,this.$state=null,this._methods=null,this._directives=null,this.$dataset=null},KitComponent.prototype.$debounce=function(fn,delay){return debounce(fn,delay,this)};function debounce(fn,delay,thisTarget){let timer=null;return function(...args){clearTimeout(timer),timer=setTimeout(()=>fn.apply(thisTarget,args),delay)}}function alias(element,attribute){const name=element.getAttribute(attribute);return name.startsWith("$")?name:null}function origin(element,attribute){return element.getAttribute(attribute)}function itSelf(self){const element=self.$element,id=element.id;if(id)return`#${id}`;var alias=element.getAttribute(self.$attribute);if(alias.startsWith("$"))return`[${self.$attribute}="${alias}"]`;const name=element.getAttribute("name");return`[${this.$attribute}="${alias}"][name=${name}]`}function normalizeOptions(options){return"state"in options||"methods"in options||"computed"in options?{state:JSON.parse(JSON.stringify(options.state)),methods:Object.assign({},options.methods),deriveds:Object.getOwnPropertyDescriptors(options.computed||{})}:parseOptions(options)}function parseOptions(options){var state={},methods={},deriveds={};const descriptors=Object.getOwnPropertyDescriptors(options);for(const key in descriptors){const desc=descriptors[key];if(typeof descriptors[key].get=="function"){deriveds[key]=desc;continue}if(typeof descriptors[key].value=="function"){methods[key]=desc.value;continue}state[key]=desc.value}return{state,methods,deriveds}}function extractDataset(element,name,prefix){if(!element)return null;const result={},startAttr=prefix?[prefix,name].join("-"):name;for(const attr of element.getAttributeNames())if(attr.startsWith(startAttr+"-")){const shortKey=attr.slice((startAttr+"-").length),shortKeySplit=shortKey.split("-"),finalKey=shortKeySplit.map((part,i)=>i===0?part:part.charAt(0).toUpperCase()+part.slice(1)).join("");result[finalKey]=element.getAttribute(attr)}return result}function parseEvents(eventText){if(!eventText.endsWith(")"))return{event:eventText,timer:0};const match=eventText.match(/^(\w+)\((\d+)\)$/);return match?{event:match[1],timer:parseInt(match[2])}:{event:eventText,timer:0}}function findNearestScope(el){for(;el;){if(el.$scope)return el.$scope;el=el.parentElement}return globalScope}kitmodule.component=KitComponent}(typeof window!="undefined"?window:globalThis),function(global){const kitmodule=global.kitmodule||(global.kitmodule={}),{component:kitComponent,scriptVersion:kitScriptVersion,event:kitEvent,element:kitElement}=kitmodule,sourceScript=document.currentScript.src,kit="kit";function KitComponents(){this.kit=kit,this.prefix="data",this.symbol=Symbol(kit),this.suffix="scope",this.marker=[this.prefix,this.kit].filter(Boolean).join("-"),this.attribute=this.directive(),this.observing=!1,this.registers=new Map,this.instances=new WeakMap,this.aliases=new Map,this.aliaser={},this.version=kitScriptVersion(sourceScript)||null,kitElement(this),kitEvent()}KitComponents.prototype.directive=function(name=this.suffix){return`${this.marker}-${name}`},KitComponents.prototype.selector=function(name=this.suffix){return name?`[${this.marker}-${name}]`:""},KitComponents.prototype.target=function(target,name=this.suffix){return`[${this.directive(name)}="${target}"]`},KitComponents.prototype.targets=function(target){return`${this.target(target)}, ${this.target(`$${target}`)} `},KitComponents.prototype.is=function(element){return element.hasAttribute(this.attribute)},KitComponents.prototype.get=function(element){return this.instances.get(element)||null},KitComponents.prototype.component=function(element){const root=element.hasAttribute(this.attribute)?element:element.closest(this.selector());return root?this.instances.get(root)||null:null},KitComponents.prototype.find=function(element,name){return name?element.querySelectorAll(this.targets(name))||[]:element.querySelectorAll(this.selector())||[]},KitComponents.prototype.ready=function(){return document.addEventListener("DOMContentLoaded",()=>{const elements=this.find(document);elements.forEach(el=>{this.register(el)})}),this},KitComponents.prototype.define=function(name,options={}){this.registers.set(name,options)},KitComponents.prototype.addAlias=function(instance){const alias=instance.$alias;if(!alias)return;if(this.aliases.has(alias)){console.error("duplicate alias ",alias);return}this.aliases.set(alias,instance),Object.defineProperty(this.aliaser,alias,{get:()=>this.aliases.get(alias),configurable:!0,enumerable:!0}),Object.defineProperty(Element.prototype,alias,{get:()=>this.aliases.get(alias),configurable:!0,enumerable:!1})},KitComponents.prototype.name=function(element){const name=element.getAttribute(this.attribute);return name.startsWith("$")?name.slice(1):name},KitComponents.prototype.parent=function(element){const root=element.hasAttribute(this.attribute)?element:element.closest(this.selector()),parent=root.parentElement?.closest(this.selector());return parent?this.instances.get(parent):null},KitComponents.prototype.register=function(element){const name=this.name(element),options=this.registers.get(name)||{};if(!this.instances.has(element)){const instance=new kitComponent(element,options,this);this.instances.set(element,instance),instance.initial?.(),this.addAlias(instance)}},KitComponents.prototype.destroy=function(element){const instance=this.instances.get(element);instance&&typeof instance.destroy=="function"&&instance._kitDestroy(),this.instances.delete(element)},KitComponents.prototype.observe=function(){if(this.observing)return;const observer=new MutationObserver(mutations=>{for(const mutation of mutations){for(const node of mutation.addedNodes){if(!(node instanceof HTMLElement))continue;this.is(node)&&this.register(node);const inner=this.find(node);inner?.forEach(el=>this.register(el))}for(const node of mutation.removedNodes){if(!(node instanceof HTMLElement))continue;this.is(node)&&this.destroy(node);const inner=this.find(node);inner?.forEach(el=>this.destroy(el))}}});observer.observe(document.body,{childList:!0,subtree:!0}),this.observing=!0},KitComponents.prototype.refresh=function(){document.querySelectorAll(selector).forEach(el=>this.register(el))};const instance=new KitComponents;kitmodule.components=instance,global.Kit=instance,global[kit]=instance.aliaser,instance.ready().observe()}(typeof window!="undefined"?window:globalThis)