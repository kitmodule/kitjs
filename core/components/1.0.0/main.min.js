(function(global){const kitmodule=global.kitmodule||(global.kitmodule={}),{component:kitComponent,scriptVersion:kitScriptVersion,scriptParam:kitScriptParam}=kitmodule,sourceScript=document.currentScript.src,dataText="data",dataParam=kitScriptParam(sourceScript,dataText)??dataText,kitText="kit",kitParam=kitScriptParam(sourceScript,kitText)??kitText,componentText="component",componentParam=kitScriptParam(sourceScript,componentText)??componentText,attrs=[dataParam,kitParam,componentParam].filter(Boolean),attribute=attrs.join("-"),selector=`[${attribute}]`,selectorTarget=name=>`[${attribute}="${name}"]`;function KitComponents(){this._attribute=attribute,this._observing=!1,this._registers=new Map,this._instances=new WeakMap,this._pending=new Set,this._aliases=new Object,this._aliaser="$"+componentText,this._data=dataParam,this._version=kitScriptVersion(sourceScript)||null}KitComponents.prototype.ready=function(){return document.addEventListener("DOMContentLoaded",()=>{const elements=document.querySelectorAll(selector);elements.forEach(el=>{this.register(el)})}),this},KitComponents.prototype.define=function(name,options={}){this._registers.set(name,options);const elements=document.querySelectorAll(selectorTarget(name));elements.forEach(el=>this.register(el))},KitComponents.prototype.register=function(element){const name=element.getAttribute(attribute),options=this._registers.get(name)||{};if(!this._instances.has(element)){const instance=new kitComponent(element,options,{name,prefix:dataParam,attribute});this._instances.set(element,instance);const alias=instance.$alias;alias&&!this._aliases.hasOwnProperty(alias)&&(this._aliases[alias]=instance),instance.initial?.()}},KitComponents.prototype.destroy=function(element){const instance=this._instances.get(element);if(instance){if(typeof instance._alias=="function"){const alias=instance.$alias;alias&&!this._aliases.hasOwnProperty(alias)&&this._aliases[alias]===instance&&delete this._aliases[alias]}typeof instance.destroy=="function"&&instance._kitDestroy()}this._instances.delete(element)},KitComponents.prototype.observe=function(){if(this._observing)return;const observer=new MutationObserver(mutations=>{for(const mutation of mutations){for(const node of mutation.addedNodes){if(!(node instanceof HTMLElement))continue;node.hasAttribute(attribute)&&this.register(node);const inner=node.querySelectorAll?.(selector);inner?.forEach(el=>this.register(el))}for(const node of mutation.removedNodes){if(!(node instanceof HTMLElement))continue;node.hasAttribute(attribute)&&this.destroy(node);const inner=node.querySelectorAll?.(selector);inner?.forEach(el=>this.destroy(el))}}});observer.observe(document.body,{childList:!0,subtree:!0}),this._observing=!0},KitComponents.prototype.refresh=function(){document.querySelectorAll(selector).forEach(el=>this.register(el))};const instance=new KitComponents;kitmodule.components=instance,global[KitComponents.name]=instance,global[instance._aliaser]=instance._aliases,instance.ready().observe()})(typeof window!="undefined"?window:globalThis)